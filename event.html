<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=0,viewport-fit=cover">
  <meta name="renderer" content="webkit">
  <meta name="keywords" content="">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <title>手写一个通用的事件绑定方法</title>
</head>

<body>
  <div id="div1">
    <a href="http://www.baidu.com" id="a">百度</a>
    <p id="p1">this is p1</p>
    <p id="p2">this is p2</p>
  </div>
  <div id="div2">
    <p id="p3">this is p3</p>
    <p id="p4">this is p4</p>
  </div>
  <script>
    var div1 = document.getElementById('div1');
    var p1 = document.getElementById('p1');
    var a = document.getElementById('a');

    function bindEvent(ele, type, selector, fn) {
      // 没有事件代理时，将第三个参数赋值给fn
      if (fn == null) {
        fn = selector
        selector = null
      }
      ele.addEventListener(type, function (e) {
        var target = e.target
        if (selector) {
          // 使用事件代理
          fn.call(target, e)
        } else {
          fn(e)
        }
      })
    }

    bindEvent(div1, 'click', a, function (e) {
      console.log('取消');
    });

    bindEvent(a, 'click', function (e) {
      e.stopPropagation();
      e.preventDefault();
      console.log('确定');
    });
  </script>
</body>

</html>